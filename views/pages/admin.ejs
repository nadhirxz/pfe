<!DOCTYPE html>
<%- include ('../partials/html') %>
<head>
	<%- include ('../partials/head') %>
	<% var texts = {
		en: [ "Waiting", "Pending", "Accepted", "Refused", "Success", "Failure"],
		fr: ["En attente", "En cours", "Accepté", "Refusé", "Succès", "Échec"],
		ar: ["انتظار", "قيد الانتظار", "قبول", "رفض", "نجاح", "فشل"]
	}; %>
	<% var classes = [ "warning", "info", "primary", "danger", "success", "danger", "warning", "danger"];%>
	<%
		function groupBy(items, key) {
			return items.reduce(
				(result, item) => ({
				...result,
				[item[key]]: [
					...(result[item[key]] || []),
					item,
				],
				}), 
				{},
			)
		}
	%>
	<% var d = groupBy(deliveries, 'status'); %>
</head>

<body>
    <%- include ('../partials/navbar') %>
    <div class="col-md-8 col-lg-5 px-5 m-auto text-center pt-3">
        <h5><span class="deliveries_today"></span><span class="font-weight-bold"><%= deliveries_today %></span> (<span class="font-weight-bold"><%= profit_today %></span> <span class="dzd"><% if (lang == 'ar') { %>دج<% } else { %>DZD<% } %></span>)</h5>
		<% if (deliveries && deliveries.length) { %>
			<div class="my-2">
				<% Object.keys(d).forEach(key => { %> <% if (d[key] && d[key].length) { %><span class="badge badge-<%= classes[key] %>">(<%= d[key].length %>) <%= texts[lang][key] %></span><% } %><% });%>
			</div>
		<% } %>
        <a type="button" class="btn btn-block btn-success mx-2 my-4 details" href="/details"></a>
        <a type="button" class="btn btn-block btn-success mx-2 my-4 shcedule" href="/schedule"></a>
        <a type="button" class="btn btn-block btn-success mx-2 my-4 partners" href="/partners/info"></a>
        <a type="button" class="btn btn-block btn-success mx-2 my-4 new_key" href="/admin/new-key"></a>
        <a type="button" class="btn btn-block btn-success mx-2 my-4 new_partner" href="/admin/new-partner"></a>
    </div>
<%- include ('../partials/footer') %>
</body>
<%- include ('../partials/scripts') %>

</html>